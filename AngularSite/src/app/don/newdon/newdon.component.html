<div class="container">
  <h3>Formulaire nouveau don</h3>

  <form class="card" 
  #form="ngForm" 
  autocomplete="off" 
  novalidate
  *ngIf="formData">
    <div class="card-body">
      <h4>Articles du don</h4>
      <div class="row">
        <div class="col-md-6">
          <div class="form-group">
            <label>Articles</label>
            <select
              [(ngModel)]="formData.idArticle"
              name="idArticle"
              #idArticle="ngModel"

              class="form-control"
            >
              <option value="0">- Selectionnez un article -</option>
              <option
                *ngFor="let item of this.articleList"
                value="{{ item.id }}"
                >{{ item.id }} - {{ item.nom }}</option
              >
            </select>
          </div>
          <div class="form-group required">
            <label>Description</label>
            <textarea
              [(ngModel)]="formData.description"
              name="description"
              #description="ngModel"
              
              class="form-control"
              rows="1"
              (input)="checkValid()"
              [class.is-valid]="descValid && reset"
              [class.is-invalid]="!descValid && description.touched"
              required
            ></textarea>
            <div *ngIf="!descValid"  class="invalid-feedback">
              Please enter a message in the textarea.
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col">
              <label>Valeur</label>
              <div class="input-group">
                <div class="input-group-prepend">
                  <div class="input-group-text">$</div>
                </div>
                <input
                  [(ngModel)]="formData.valeur"
                  name="valeur"
                  #valeur="ngModel"

                  class="form-control"
                  min="1"
                  type="number"
                  required
                />
                <div *ngIf="!prixValid"  class="invalid-feedback">
                  Please enter a message in the textarea.
                </div>
              </div>
            </div>

            <div class="form-group col">
              <label>Quantite</label>
              <input
                [(ngModel)]="formData.quantite"
                name="quantite"
                #quantite="ngModel"

                class="form-control"
                min="1"
                type="number"
                required
              />
            </div>

            <div class="form-group col">
              <label>Total</label>
              <div class="input-group">
                <div class="input-group-prepend">
                  <div class="input-group-text">$</div>
                </div>
                <input disabled class="form-control" 
                value="{{ formData.quantite * formData.valeur }}" />
              </div>
            </div>
          </div>
          <div class="form-group">
            <button (click)="onSubmit()" class="btn btn-primary float-right">
              Ajouter l'article
            </button>
            <button (click)="clearArticle()" class="btn btn-outline-secondary">
              Annuler l'article
            </button>
          </div>
        </div>
        <div class="col-md-6">
          <label>Liste des items</label>
          <table class="table">
            <thead>
              <tr>
                <th scope="col">Article</th>
                <th scope="col">Valeur</th>
                <th scope="col">Quantite</th>
                <th scope="col">Description</th>
              </tr>
            </thead>
            <tbody>
<!-- 
              <tr *ngIf="service.orderItems.length==0" [class.text-danger]="!isValid && service.orderItems.length==0">
                <td class="font-italic text-center" colspan="5">
                  No foot item selected for this order
                </td>
              </tr> -->

              <tr *ngFor="let item of this.donArticleList.reverse()">
                <td>{{ item.id }} - {{ item.nom }}</td>
                <td>{{ item.valeur }}</td>
                <td>{{ item.quantite }}</td>
                <td>{{ item.description }} = {{ item.valeur * item.quantite }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <hr />
          <button (click)="promesse()" class="btn btn-success float-right">
            Promettre le don
          </button>
          <button (click)="annulerDon()" class="btn btn-outline-secondary">
            Annuler le don
          </button>
        </div>
      </div>
    </div>
  </form>
  <div class="bg-light mt-3">
    <div class="card-body">
      <p class="m-0">Termes et conditions:</p>
      <p class="my-0 ml-3">
        Les vetements doivent etre propre. Aucun sous-vetements.
      </p>
      <p class="my-0 ml-3">
        Seulement la nourriture en canne. La nourriture fraiche n'est pas
        accepte.
      </p>
    </div>
  </div>
</div>
